<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
		<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
		<script src="http://code.jquery.com/jquery-latest.min.js"></script>
		 <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
		   integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
		   crossorigin=""/>
    <!-- Make sure you put this AFTER Leaflet's CSS -->
		<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
		   integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
		   crossorigin=""></script>
		  <style type="text/css">
		   html, body {
			margin:0;
			padding:0;
			background-color:rgb(59, 59, 59);
			}
		</style>
	</head>
	<body>
	<div class="container text-white">
		<div class="row">
			<div class="col-sm">
			</div>
		<div class="col-md">
			<div id="test" style="width: 50%px; height: 150px;">
				<p>Choisir un réalisateur</p>
				<FORM>
				<SELECT  id="myList" name="nom" size="1">
				</SELECT>
				</FORM>
				 <button type="button" onclick="showFilmByReal()">Ajout lieux tournage</button> 
				 <button type="button" onclick="clearMarkers()">Clear</button> 
			</div>
		</div>
		<div class="col-sm">
		</div>
		<div id="mapid" style="width: 100%; height: 550px;"></div>
		</div>
	</div>
		<script type="text/javascript">	
		var removeLayers = [];	<!-- Conteneur de nos futurs Pins-->
		
		var mymap = L.map('mapid').setView([48.864716, 2.349014], 12);
		 
		L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
		maxZoom: 18,
		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
			'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
			'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
		id: 'mapbox.streets'
		}).addTo(mymap);
		
		<!-- Liste des réalisateurs -->
		fetch('https://opendata.paris.fr/api/records/1.0/search/?dataset=tournagesdefilmsparis2011&facet=realisateur&facet=organisme_demandeur&facet=type_de_tournage&facet=ardt')
		  .then(
			function(response) {
			  if (response.status !== 200) {
				console.log('Looks like there was a problem. Status Code: ' +
				  response.status);
				return;
			  }
		
			response.json().then(function(data) {
				var i;
				for(i=0; i<data.facet_groups[0].facets.length; i++){
				var node = document.createElement("OPTION");                 // Create a <li> node -->
				var textnode = document.createTextNode(data.facet_groups[0].facets[i].name);         // Create a text node
				node.appendChild(textnode);                              // Append the text to <li> -->
				document.getElementById("myList").appendChild(node); 
				}
			});
			}
		  );	

		function showFilmByReal(){
			var real = document.getElementById('myList').value;
			var splitter = real.split(" ");
			var prenom = splitter[0]
			var nom = splitter[1]
			
			fetch('https://opendata.paris.fr/api/records/1.0/search/?dataset=tournagesdefilmsparis2011&facet=realisateur&facet=ardt&refine.realisateur='+prenom+"+"+nom)
		  .then(
			function(response) {
			  if (response.status !== 200) {
				console.log('Looks like there was a problem. Status Code: ' +
				  response.status);
				return;
			  }

			  // Examine the text in the response
			  response.json().then(function(data) {
				var i;
				for(i=0; i<data.records.length; i++){
					var one = data.records[i].geometry.coordinates[0]
					var two = data.records[i].geometry.coordinates[1]
					var marker = L.marker([two,one]).addTo(mymap);
					mymap.addLayer(marker);
					removeLayers.push(marker);
					marker.bindPopup("<b>"+data.records[i].fields.titre+"</b><br>"+data.records[i].fields.realisateur).openPopup();
					}
			  });
			}
		  );
		}
		
		function clearMarkers(){
			for (var i=0;i<removeLayers.length;i++) {  			
			   mymap.removeLayer(removeLayers[i]);  
			}
			removeLayers=[];
			} 
		 </script>
	</body>
</html>		


